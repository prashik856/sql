# Select Statement

Used to select data from a database
```sql
select * from Customers;
```

## Syntax
```sql
select column1, colum2, ... from table_name;
```
columns are filed names.
If we want all fields

```sql
select * from table_name;
```

## Select Column
```sql
select customername, city from customers;
select * from customers;
```

## Distinct statement
Return only distinct (different) values.
```sql
select distinct column1, column2, ... from table_name;
select Country from Customers;
select distinct country from customers;
```

## Distinct Count
```sql
select count(distinct Country) from customers;
/*
The above query might not work in Microsoft access db.
*/
select count(*) as distincyCountries from ( select distinct Country from Customers);
```

## Where Clause
Where clause is used to filter records.
```sql
select column1, column2, ...
from table_name
where condition;
```
Where clause is also used in Update and Delete, etc.

```sql
select * from customers where country='Mexico';
```
For text vs numeric fields
```sql
select * from customers where customerid=1;
```

Operators in where clause
```sql
/*
= Equal
> Greater than
< Less than
>= Greater than or equal
<= Less than or equal
<> Not equal. In some versions, we have != as not equal
between - between a certain range
like - search for pattern
in - to specify multiple possible values for a column
*/
```

## AND, OR and NOT Operators
Where clause can be combined with AND, OR and NOT Operators.
AND - all are true
OR - any one of them is true
NOT - not true

And syntax
```sql
select column1, column2, ...
from table_name
where condition1 and condition2 and condition3 ...;
```

OR syntax
```sql
select column1, column2, ...
from table_name
where condition1 or condition2 or condition3 ...;
```

Not syntax
```sql
select column1, column2, ...
from table_name
where not condition;
```

Examples:
```sql
select * from customers 
where country='Germany' AND City='Berlin';

select * from Customers where City='Berlin' or City='Munchen';

select * from Customers where Country='Germany' or Country='Spain';

select * from customers where not country='Germany';
```

Combining and, or and not
```sql
select * from customers 
where country='Germany' and 
      (City='Berlin' or city='Muchen');

select * from customers 
         where not country='Germany' 
           and not country='usa';
```

## Order keyword
order by is used to sort the result-set.
desc keyword is used for decending and asc is used for ascending order.

```sql
select column1, column2, ...
from table_name
order by column1, column2, ...
ASC|DESC;
```

Order by example
```sql
select * from customers order by country;

select * from customers order by country desc;
```

Order by several columns. First column takes preference.
```sql
select * from customers
order by country, customername;
```

Sorted ascending by country, and descending by customername
```sql
select * from customers
order by country asc, customername desc;
```

## Null values
Null values ia field with no value.
How to test null values? We use these

is null syntax
```sql
select column_names 
from table_name
where column_name is null;
```

is not null syntax
```sql
select column_names
from table_name
where column_name is not null;
```

The is null Operator. Used to test for empty values (null values)
```sql
select customername, contactname, address 
from customers 
where address is null;
```
Always use is null to look for null values.

The is no null operator, used to test for non-empty values.
```sql
select customername, contactname, address
from customers 
where address is not null;
```

## TOP, LIMIT, FETCH FIRST OR ROWNUM Clause
select top clause is used to specify the number of records to return.
Useful in large tables with thousands of records.

Not all databases supports *select top* clause.
Mysql supports limit clause.
Oracle uses *Fetch First n rows only* and *Rownum*

SQL Server/MS Access Syntax:
```sql
select top number|percent
column_name(s)
from table_name
where condition;
```

MySQL Syntax:
```sql
select column_names(s)
from table_name
where condition
limit number;
```

Oracle 12 Syntax:
```sql
select column_name(s)
from table_name
order by column_name(s)
fetch first number rows only;
```

Older Oracle Syntax
```sql
select column_name(s)
from table_name
where rownum <= number;
```

Older Oracle Syntax (with Order by)
```sql
from (select column_name(s) 
    from table_name order by column_name(s))
where rownum <= number;
```

Examples
```sql
select top 3 * from customers;

// mysql equivalent
select * from customers limit 3;

// Oracle equivalent
select * from customers fetch first 3 rows only;
```

Top percent example. for sql server/ms access
```sql
select top 50 percent * from customers;

// Oracle
select * from customers fetch first 50 percent rows only;
```

Add a where clause
```sql
select top 3 * from customers where country='Germany';

// mysql equivalent
select * from customers where country='Germany' limit 3;

// Oracle
select * from customers where country = 'Germany'
fetch first 3 rows only;
```

## Min Max
Min - returns smallest value of selected column
Max - returns max value of selected column

Syntax
```sql
select MIN(column_name) from table_name where condition;

select MAX(column_name) from table_name where condition;
```

Example
```sql
// min example
select min(Price) as SmallestPrice from Products;

// max example
select max(Price) as LargestPrice from Products;
```

## Count, Avg, sum
Count - returns number of rows that matches a specified criterion
avg - returns average value of numeric column
sum - returns total sum of numeric column

Syntax
```sql
// count
select count(column_name) from table_name where condition;

// avg
select avg(column_name) from table_name where condition;

// sum
select sum(column_name) from table_name where condition;
```

Examples
```sql
// Null values are not counted in count
select count(ProuctId) from Products

// null values are ignored
select avg(Price) from products;

// null values are ignored
select sum(quality) from Orderdetails;
```

## Like Operator
Used in where clause to search for specific pattern in column.

There are two wildcards often used in conjunction with the LIKE operator:
- The percent sign (%) represents zero, one, or multiple characters
- The underscore sign (_) represents one, single character

NOTE: MS Access uses an asterisk (*) instead of the percent sign (%), and a question mark (?) instead of the underscore (_).

Syntax
```sql
// like
select column1, column2, ... from table_name where columnN like pattern;

// Combine any number of conditions using AND or OR operators
WHERE CustomerName LIKE 'a%'	Finds any values that start with "a"
WHERE CustomerName LIKE '%a'	Finds any values that end with "a"
WHERE CustomerName LIKE '%or%'	Finds any values that have "or" in any position
WHERE CustomerName LIKE '_r%'	Finds any values that have "r" in the second position
WHERE CustomerName LIKE 'a_%'	Finds any values that start with "a" and are at least 2 characters in length
WHERE CustomerName LIKE 'a__%'	Finds any values that start with "a" and are at least 3 characters in length
WHERE ContactName LIKE 'a%o'	Finds any values that start with "a" and ends with "o"
```

EXAMPLES:
```sql
// STARTS WITH a
SELECT * FROM Customers
WHERE CustomerName LIKE 'a%';

// ends with a
SELECT * FROM Customers
WHERE CustomerName LIKE '%a';

// has or in it
SELECT * FROM Customers
WHERE CustomerName LIKE '%or%';

// Customer that has r in 2nd position
SELECT * FROM Customers
WHERE CustomerName LIKE '_r%';

// Customer that starts with a, and has atleast 3 letters
SELECT * FROM Customers
WHERE CustomerName LIKE 'a__%';

// Customer that starts with a and ends with o
SELECT * FROM Customers
WHERE ContactName LIKE 'a%o';

// Customer that does not starts with a
SELECT * FROM Customers
WHERE CustomerName NOT LIKE 'a%';
```

## Wildcards
A wildcard character is used to substitute one or more characters 
in a string.
Wildcard characters are used with the LIKE operator. 
The LIKE operator is used in a WHERE clause to search for a specified pattern in a column.

Wildcard Characters in MS Access
```
Symbol	Description	                                                Example
*	    Represents zero or more characters	                        bl* finds bl, black, blue, and blob
?	    Represents a single character	                            h?t finds hot, hat, and hit
[]	    Represents any single character within the brackets	        h[oa]t finds hot and hat, but not hit
!	    Represents any character not in the brackets	            h[!oa]t finds hit, but not hot and hat
-	    Represents any single character within the specified range	c[a-b]t finds cat and cbt
#	    Represents any single numeric character	                    2#5 finds 205, 215, 225, 235, 245, 255, 265, 275, 285, and 295
```

Wildcard Characters in SQL Server
```
Symbol	Description	                                                Example
%	    Represents zero or more characters	                        bl% finds bl, black, blue, and blob
_	    Represents a single character	                            h_t finds hot, hat, and hit
[]	    Represents any single character within the brackets	        h[oa]t finds hot and hat, but not hit
^	    Represents any character not in the brackets	            h[^oa]t finds hit, but not hot and hat
-	    Represents any single character within the specified range	c[a-b]t finds cat and cbt
```

Examples using like
```sql

LIKE Operator	                Description
WHERE CustomerName LIKE 'a%'	Finds any values that starts with "a"
WHERE CustomerName LIKE '%a'	Finds any values that ends with "a"
WHERE CustomerName LIKE '%or%'	Finds any values that have "or" in any position
WHERE CustomerName LIKE '_r%'	Finds any values that have "r" in the second position
WHERE CustomerName LIKE 'a__%'	Finds any values that starts with "a" and are at least 3 characters in length
WHERE ContactName LIKE 'a%o'	Finds any values that starts with "a" and ends with "o"
```

Examples of wildcard
```sql
SELECT * FROM Customers
WHERE City LIKE 'ber%';

SELECT * FROM Customers
WHERE City LIKE '%es%';

// Starts with any character but ends with ondon
SELECT * FROM Customers
WHERE City LIKE '_ondon';

// _ is single character wildcard
SELECT * FROM Customers
WHERE City LIKE 'L_n_on';

// all customers starting with letters b,s,p
SELECT * FROM Customers
WHERE City LIKE '[bsp]%';

// all customers starting with letters a,b,c
SELECT * FROM Customers
WHERE City LIKE '[a-c]%';

// all customers not starging with letters b,s,p
SELECT * FROM Customers
WHERE City LIKE '[!bsp]%';

// similar query but with like
SELECT * FROM Customers
WHERE City NOT LIKE '[bsp]%';
```

## IN operator
The IN operator allows you to specify multiple values in a WHERE clause.
The IN operator is a shorthand for multiple OR conditions.

IN Syntax
```sql
SELECT column_name(s)
FROM table_name
WHERE column_name IN (value1, value2, ...);

SELECT column_name(s)
FROM table_name
WHERE column_name IN (SELECT STATEMENT);
```

Examples
```sql
// all customers located in Germany, France or UK
SELECT * FROM Customers
WHERE Country IN ('Germany', 'France', 'UK');

// same above but not in Germany, France, UK
SELECT * FROM Customers
WHERE Country NOT IN ('Germany', 'France', 'UK');

// Select all customers from contries which are suppliers
SELECT * FROM Customers
WHERE Country IN (SELECT Country FROM Suppliers);
```

## Between Clause
The BETWEEN operator selects values within a given range. The values can be numbers, text, or dates.
The BETWEEN operator is inclusive: begin and end values are included. 

Between Syntax:
```sql
SELECT column_name(s)
FROM table_name
WHERE column_name BETWEEN value1 AND value2;
```

Examples
```sql
SELECT * FROM Products
WHERE Price BETWEEN 10 AND 20;

// Using not
SELECT * FROM Products
WHERE Price NOT BETWEEN 10 AND 20;

// With In Clause
// The following SQL statement selects all products with a price 
// between 10 and 20. In addition; do not show products with
// a CategoryID of 1,2, or 3
SELECT * FROM Products
WHERE Price BETWEEN 10 AND 20
AND CategoryID NOT IN (1,2,3);

// Text values
SELECT * FROM Products
WHERE ProductName BETWEEN 'Carnarvon Tigers' AND 'Mozzarella di Giovanni'
ORDER BY ProductName;

SELECT * FROM Products
WHERE ProductName BETWEEN "Carnarvon Tigers" AND "Chef Anton's Cajun Seasoning"
ORDER BY ProductName;

// Not between
SELECT * FROM Products
WHERE ProductName NOT BETWEEN 'Carnarvon Tigers' AND 'Mozzarella di Giovanni'
ORDER BY ProductName;
```

Demo Database Examples
```sql
// Date example
SELECT * FROM Orders
WHERE OrderDate BETWEEN #07/01/1996# AND #07/31/1996#;

// Better way that the one above
SELECT * FROM Orders
WHERE OrderDate BETWEEN '1996-07-01' AND '1996-07-31';
```

## SQL Alias
